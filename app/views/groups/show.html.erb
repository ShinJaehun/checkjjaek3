<p id="notice"><%= notice %></p>

<p>
  <strong>Group Name:</strong>
  <%= @group.name %>
</p>

<p>
  <strong>Description:</strong>
  <%= @group.description %>
</p>

<p>
  <strong>Group Users:</strong>
  <% @group.users.each do |user| %>
    <li>
      <%= user.name %>
    </li>
  <% end %>
</p>

<% if !current_user.groups.include?(@group) %>
  <%= form_tag join_group_path(@group) do %>
    <button type="submit" class="btn btn-lg">Join</button>
  <% end %>
<% else %>
  <%= form_tag leave_group_path(@group) do %>
    <%= link_to "Leave", { action: 'leave_group' }, class: 'btn btn-lg', method: 'delete', data: { confirm: 'Are you sure?' } %>
  <% end %>
<% end %>

<p>
  <strong>Group User Post</strong>
  <table>
    <tbody>
      <% @posts.each do |post| %>
        <% if post.postable_type == "Message" %>
          <tr>
            <td><%= post.content %></td>
            <td>by <%= post.user.name %></td>
            <td><%= link_to 'Edit', edit_post_path(post) %></td>
            <td><%= link_to 'Destroy', post, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          </tr>
        <% end %>
      <% end %>
    </tbody>
  </table>
</p>

<%= form_for(@message) do |f| %>
  <%#= f.hidden_field :sender_id, value: current_user.id %>
  <%#= f.hidden_field :receiver_id, value: @group.id %>
  <%= hidden_field_tag :receiverrr_id, @group.id %>

  <div class="field">
    <%= f.fields_for :posts do |p| %>
      <%#= p.hidden_field :user_id, value: current_user.id %>
      <%= p.hidden_field :post_recipient_type, value: 'group' %>

      <%= p.text_area :content %>
    <% end %>
  </div>

  <%= f.submit %>
<% end %>

<%= link_to 'Edit', edit_group_path(@group) %> |
<%= link_to 'Back', groups_path %>
